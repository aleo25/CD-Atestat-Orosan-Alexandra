(()=>{"use strict";const t=async t=>new Promise(((e,i)=>{const s=new XMLHttpRequest;s.onload=()=>{e(s.responseText)},s.onerror=()=>{i(new Error("Local request failed"))},s.open("GET",t),s.send()})),e=async e=>JSON.parse(await t(e)),i=new Map,s=async(t,s)=>{const n=`${t}/assets/locales/${s}.json`;if(!i.has(n)){const t=await e(n);t&&i.set(n,t)}return i.get(n)},n=(t,e,i=0,s=0)=>new Intl.NumberFormat(t,{minimumFractionDigits:i,maximumFractionDigits:s}).format(e),r=t=>(e,i,s)=>{const r=new RegExp(`{${i},[ ]*number}`,"g");return e.replaceAll(r,n(t,+s))},a=(t,e,i)=>{const s=new RegExp(`{${e}, plural, .+?}}`,"g");let n=new RegExp("=0[ ]*{(.*?)}","g");const r=+i;1===r?n=new RegExp("one[ ]*{(.*?)}","g"):r>1&&(n=new RegExp("other[ ]*{(.*?)}","g"));const a=n.exec(t);return a?t.replaceAll(s,a[1].replace("#",i)):t},o=(t,e,i)=>t.replaceAll(`{${e}}`,i),l=(t,e,i)=>{const s=new RegExp(`{${e}, select, .+?}[ ]*}`,"g"),n=new RegExp(`${i}[ ]*{(.*?)}`,"g").exec(t);return n?t.replaceAll(s,n[1]):t},c=async(t,e,i,n)=>{let c;try{if(c=await s(t,e),!c)throw new Error(`Could not find ${e} object`)}catch(e){c=await s(t,"en-GB")}if(!c)return i;let d=c[i];return d||(d=i.split(".").reduce(((t,e)=>t[e]),c)),d&&((t,e,i)=>{if(!e||!i)return e;const s=[a,r(t),o,l];return Object.entries(i).reduce(((t,[e,i])=>s.reduceRight(((t,s)=>s(t,e,i)),t)),e)})(e,d,n)||i},d=t=>e=>{customElements.get(t.selector)||customElements.define(t.selector,e)},h=t=>{const e=unescape(encodeURIComponent(t));let i="";for(let t=0;t<e.length;t++)i+=e.charCodeAt(t).toString(16);return i};var u;!function(t){t.MPN="mpn",t.GTIN="gtin",t.SKU="sku"}(u||(u={}));const p=u;class m{identifiers;type;constructor(t,e,i){if(t)this.identifiers=t,this.type=p.SKU;else if(e)this.identifiers=e,this.type=p.GTIN;else{if(!i)throw new Error("No product identifier data attribute found.");this.identifiers=i,this.type=p.MPN}}getIdentifiers(){return this.identifiers}getEncodedIdentifiers(){return this.type===p.SKU?this.identifiers.map((t=>h(t))):this.identifiers}getCombinedIdentifier(){return this.type===p.SKU?this.identifiers.map((t=>({identifier:t,encoded:h(t)}))):this.identifiers.map((t=>({identifier:t,encoded:null})))}getType(){return this.type}}const g="$_PRODUCT_IDENTIFIER",v=async t=>{const i=await e(t);if("object"==typeof(s=i)&&0===Object.keys(s).length)throw new Error("Server returned empty object!");var s;return i},T=async(t,e,i,s)=>{const n=t.replace("$_PRODUCT_IDENTIFIER_TYPE",e).replace(g,i).replace("$_FILTER","default/all").concat(s||"");return v(n)},E=["oneStar","twoStars","threeStars","fourStars","fiveStars"];var f;!function(t){t.AGGREGATERATING="AggregateRating",t.PRODUCTGROUP="ProductGroup",t.PRODUCT="Product",t.OFFER="Offer",t.REVIEW="Review",t.RATING="Rating",t.PERSON="Person",t.BRAND="Brand",t.ORGANIZATION="Organization"}(f||(f={}));const w=f,y=t=>{const e=t.firstName??"",i=t.lastName??"";return`${e}${""!==e?` ${i}`:`${i}`}`},b=t=>t.filter((t=>void 0!==t.consumer&&void 0!==t.rating)).sort(((t,e)=>e.rating-t.rating)).slice(0,10).map((t=>({"@type":w.REVIEW,author:{"@type":w.PERSON,name:y(t.consumer).trim()},datePublished:new Date(t.submittedAt).toISOString().substring(0,10),reviewBody:t.comment,name:t.title,publisher:{"@type":w.ORGANIZATION,name:"Trusted Shops",url:"www.trustedshops.de"},reviewRating:{"@type":w.RATING,bestRating:"5",worstRating:"1",ratingValue:`${t.rating}`}}))),A=t=>({"@type":w.AGGREGATERATING,ratingValue:t.rating.toString(),reviewCount:t.count.toString()}),R=(t,e)=>{const{products:i,grade:s,reviews:n}=t,r=i[0],a=!e||!e.find((t=>!!t.brand)),o=r?.image&&r.image.original?r.image.original.url:void 0;return{"@context":"https://schema.org","@type":w.PRODUCT,"@id":r.sku,aggregateRating:A(s),sku:r.sku,name:r.name,gtin:r.gtin,mpn:r.mpn,brand:r.brand&&a?{"@type":w.BRAND,name:r.brand}:void 0,image:o,review:b(n)}};var S;!function(t){t.OS="os",t.LIGHT="light",t.DARK="dark"}(S||(S={}));const C=S;var L;let O=L=class extends HTMLElement{data;filter;baseUrl;locale;grade;channel;constructor(t,e){if(super(),this.data=t,this.filter=e,!this.data)return;const{grade:i,baseUrl:s,locale:n,channel:r}=this.data;this.grade=i,this.baseUrl=s,this.locale=n,this.channel=r}async connectedCallback(){this.innerHTML||await this.render()}static getPercentageBar(t,e){const i=L.getHtmlElement("div","","distribution-row");return i.setAttribute("data-filter-value",t.toString()),i.innerHTML=`\n      <span class="rating-index">\n        ${t} <span class="rating-star"><img class="star empty"/></span>\n      </span>\n      <div class="bar">\n        <div class="bar-filled" style="width: ${e}%"></div>\n      </div>\n      <span class="percent"> ${e}% </span>\n    `,i}static getHtmlElement(t,e,...i){const s=document.createElement(t);return s.innerHTML=e,s.classList.add(i.join(" ")),s}async getEmptyHeaderHtml(){return`\n        <div class="rating-distribution">\n          <div class="header">\n            <span class="message">\n              ${await c(this.baseUrl,this.locale,"header.noRatingYet")}\n            </span>\n            <span class="logo">\n            </span>\n          </div>\n        </div>\n      `}getHeaderHtml(t){const e=`\n      <span class="rating">\n        ${n(this.locale,this.grade.rating,2,2)}\n      </span>\n      <span class="review-count"> ${t} </span>\n      <span class="logo">\n      </span>`;return L.getHtmlElement("div",e,"header")}getBodyHtml(t,e){const{oneStar:i,twoStars:s,threeStars:n,fourStars:r,fiveStars:a}=t,o=L.getHtmlElement("div","","body"),l=[i,s,n,r,a].map((t=>{return i=t,s=e,isNaN(i)||0===s?0:Math.round(100*i/s);var i,s})).map(((t,e)=>L.getPercentageBar(e+1,t))).reverse();return this.filter?.addAsFilterElement(l,"stars"),o.append(...l),o}static async getFooterHtml(t,e){const i=`\n      <span>${t}</span>\n      <span>${e}</span>\n    `;return L.getHtmlElement("div",i,"footer")}async render(){this.innerHTML="";const{count:t,distribution:e}=this.grade;if(!(t>0))return void(this.innerHTML=await this.getEmptyHeaderHtml());const i=await c(this.baseUrl,this.locale,"header.totalReviewCount",{totalReviewCount:t.toString()}),s=L.getHtmlElement("div","","rating-distribution"),n=await c(this.baseUrl,this.locale,"common.legalText"),r=await c(this.baseUrl,this.locale,"common.legalText2",{reviewLegalUrl:`${this.channel.seoProfileUrl}#legal`}),a=this.getHeaderHtml(i),o=this.getBodyHtml(e,t),l=await L.getFooterHtml(n,r);s.append(a,o,l),this.innerHTML="",this.append(s)}};O=L=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-rating-distribution"})],O);const U=O;class I{stars=new Set;language=new Set;reply=!1;setStars(t){return this.stars.has(t)?this.stars.delete(t):this.stars.add(t),5===this.stars.size&&this.stars.clear(),this}}var _;!function(t){t.STARS="stars",t.REPLY="reply",t.LANGUAGE="language"}(_||(_={}));let $=class extends HTMLElement{reviewListElement;CLOSED_CLASS="closed";OPENED_CLASS="open";opened=!1;baseUrl;locale;grade;theme;filter=new I;filterElements=new Map;mapping;dropdown;eventListener;constructor(t,e){super(),this.reviewListElement=e,this.locale=t.locale,this.baseUrl=t.baseUrl,this.theme=t.theme,this.grade=t.grade,this.mapping=new Map([[5,this.grade.distribution.fiveStars],[4,this.grade.distribution.fourStars],[3,this.grade.distribution.threeStars],[2,this.grade.distribution.twoStars],[1,this.grade.distribution.oneStar]]),this.setAttribute("theme",this.theme)}async connectedCallback(){this.createBaseElement(),this.eventListener=t=>{this.isOutSideClick(t)},window.addEventListener("click",this.eventListener),0!==this.grade.rating&&this.render()}async disconnectedCallback(){this.dropdown?.remove(),window.removeEventListener("click",this.eventListener)}async isOutSideClick(t){this.contains(t.composedPath()[0])||this.close()}createBaseElement(){this.dropdown=document.createElement("div"),this.dropdown.classList.add("review-filter",this.CLOSED_CLASS)}toggle(t){t.stopPropagation(),this.opened?this.close():this.open()}open(){this.opened=!0,this.dropdown.classList.remove(this.CLOSED_CLASS),this.dropdown.classList.add(this.OPENED_CLASS)}close(){this.opened=!1,this.dropdown.classList.remove(this.OPENED_CLASS),this.dropdown.classList.add(this.CLOSED_CLASS)}async resetFilter(){this.filter=new I,await this.reviewListElement.update((async t=>t)),await this.setStarFilter()}addAsFilterElement(t,e,i=_.STARS){this.filterElements.set(e,[...t,...this.filterElements.get(e)??[]]),t.forEach((t=>{t.onclick=e=>{e.stopPropagation(),this.updateFilter(t,i)}}))}async setStarFilter(){this.filterElements.get("stars").forEach((t=>{const e=Number(t.getAttribute("data-filter-value"));this.filter.stars.has(e)?t.classList.add("active"):t.classList.remove("active")}))}async updateFilter(t,e=_.STARS){const i=t.getAttribute("data-filter-value");if(e===_.STARS){this.filter.setStars(Number(i));const t=this.filterReviews.bind(this);await this.reviewListElement.update(t),await this.setStarFilter()}return this.filter}async filterReviews(t){let e;return this.filter.stars&&this.filter.stars.size>0&&(e=t.filter((t=>this.filter.stars.has(t.rating)))),this.filter.language&&this.filter.language.size>0&&(e=t.filter((t=>this.filter.language.has(t.locale)))),this.filter.reply&&(e=t.filter((t=>t.reply))),e??t}async getDropDown(){const t=[...Array(5).keys()].map((t=>{const e=t+1,i=document.createElement("li");return i.setAttribute("data-filter-value",e.toString()),i.innerHTML=`\n            <etrusted-rl-star-rating\n              baseurl="${this.baseUrl}"\n              rating="${e}"\n              theme="${this.theme}"\n            ></etrusted-rl-star-rating>\n            <span>\n              (${this.mapping.get(e)})\n            </span>\n      `,i}));this.addAsFilterElement(t,"stars");const e=document.createElement("div");e.classList.add("filter");const i=document.createElement("span");i.innerText=await c(this.baseUrl,this.locale,"filter.header");const s=document.createElement("a");s.innerText=await c(this.baseUrl,this.locale,"filter.removeFilter"),s.onclick=()=>this.resetFilter();const n=document.createElement("ol");return n.classList.add("filter-list"),n.append(...t.reverse()),e.prepend(i),e.append(n),e.append(s),e}async render(){const t=await this.getDropDown(),e=document.createElement("button"),i=await c(this.baseUrl,this.locale,"filter.label");e.innerHTML=`\n      ${i}\n      <span class="icon"></span>\n    `,e.onclick=t=>this.toggle(t),this.dropdown.append(t,e),this.append(this.dropdown)}};$=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-review-filter"})],$);const N=$,M=(t,e)=>{const i=new Intl.RelativeTimeFormat(t,{numeric:"auto"}),s=new Date,n=new Date(e),r=n.getTime()-s.getTime(),a=Math.trunc(r/1e3),o=Math.abs(a);let l=a,c="second";if(o>=60&&o<3600)l=Math.trunc(a/60),c="minute";else if(o>3600&&o<86400)l=Math.trunc(a/3600),c="hour";else if(o>=86400&&o<604800)l=Math.trunc(a/86400),c="day";else if(o>604800)return n.toLocaleDateString(t);return i.format(l,c)};var x;!function(t){t.CENTER="center",t.LEFT="left",t.RIGHT="right"}(x||(x={}));let P=class extends HTMLElement{ATTRIBUTE_CONTENT="content";ATTRIBUTE_ORIENTATION="orientation";content;orientation;toolTipContainer;async connectedCallback(){this.content=this.getAttribute(this.ATTRIBUTE_CONTENT)||"",this.orientation=this.getAttribute(this.ATTRIBUTE_ORIENTATION)||x.CENTER,requestIdleCallback((()=>{this.addEventListener("mouseenter",(()=>this.open())),this.addEventListener("mouseleave",(()=>this.close()))}))}open(){this.toolTipContainer?this.toolTipContainer.style.display="block":this.render()}close(){this.toolTipContainer.style.display="none"}setPosition(t){const e=this.children[0],i=-this.toolTipContainer.offsetWidth/2+e.getBoundingClientRect().width/2;t.style.left=`${i}px`}render(){this.toolTipContainer=document.createElement("div"),this.toolTipContainer.classList.add("tooltip-wrapper"),this.toolTipContainer.classList.add(this.orientation),this.toolTipContainer.innerHTML=`\n      <div class="tooltip">\n        <span>${this.content}</span>\n      </div>\n    `,this.appendChild(this.toolTipContainer),this.setPosition(this.toolTipContainer)}};P=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-rc-tooltip"})],P);const B=t=>e=>{customElements.get(t.selector)||customElements.define(t.selector,e)};let D=class extends HTMLElement{ATTRIBUTE_RATING="rating";MIN_GRADE=0;MAX_GRADE=5;async connectedCallback(){const t=+(this.getAttribute(this.ATTRIBUTE_RATING)??0);this.validate(t)&&this.render(t)}validate(t){return!(isNaN(t)||t<this.MIN_GRADE||t>this.MAX_GRADE)}render(t){const e=Math.floor(t),i=t%1*100,s='<div class="empty"></div>',n='<div class="filled"></div>';this.innerHTML=`\n      <div class="star-rating">\n        ${n.repeat(e)}\n        ${e!==this.MAX_GRADE?`\n              <div class="star-rating__fraction">\n                <div class="star">\n                  ${s}\n                </div>\n                <div class="star" style="width: ${i}%">\n                  ${n}\n                </div>\n              </div>\n              ${s.repeat(this.MAX_GRADE-e-1)}\n            `:""}\n      </div>\n    `}};D=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([B({selector:"etrusted-ig-star-rating"})],D);const G=(t,e,i="lazy",s)=>`<img src="${t}/assets/images/${e}.svg" loading="${i}" ${s?`class="${s}"`:""} />`;let H=class extends HTMLElement{ATTRIBUTE_BASE_URL="baseUrl";ATTRIBUTE_LOCALE="locale";locale;baseUrl;wrapperElement;reviewWrapperElement;indicatorElement;dotSlider;slides;observer;_data;currentIndex=0;imageCount=0;translateContent;get data(){return this._data}set data(t){this._data=t,this.imageCount=this._data.review.images.length,this.render()}connectedCallback(){this.baseUrl=this.getAttribute(this.ATTRIBUTE_BASE_URL)||"",this.locale=this.getAttribute(this.ATTRIBUTE_LOCALE)||"",this.translateContent=c.bind(this,this.baseUrl,this.locale)}disconnectedCallback(){this.unobserveSlideVisibility()}show(t=0){this.currentIndex=t,this.wrapperElement.classList.add("show"),this.scrollToSlide(this.currentIndex)}hide(){this.wrapperElement.classList.remove("show")}showOverlay(t){this.reviewWrapperElement.classList.add("overlay"),t.stopPropagation()}hideOverlay(t){this.reviewWrapperElement.classList.remove("overlay"),t.stopPropagation()}scrollToSlide(t=0){const e=this.querySelector(`#slide-${t}`);e&&e.scrollIntoView()}previousSlide(){this.currentIndex=this.currentIndex>0?this.currentIndex-1:this.imageCount-1,this.scrollToSlide(this.currentIndex)}nextSlide(){this.currentIndex=this.currentIndex<this.imageCount-1?this.currentIndex+1:0,this.scrollToSlide(this.currentIndex)}async reportImage(t){const{channel:e,review:i}=this.data,s=i.id,n=new Date(i.date).toLocaleString("en-GB").substring(0,10),r=await this.translateContent("report.body"),a="-".repeat(40),o=e?`${e.tsId} / ${s} / ${t.id} / ${e.name}`:`${s} / ${t.id}`,l=`${t.url}\n${i.comment||""}`,c=`${i.rating}/5 - ${n}`,d=await this.translateContent("report.subject",{imageId:t.id}),h=`${r}\n\n${a}\n${o}\n\n${l}\n\n${c}`;window.open(`mailto:reviewservice@trustedshops.com?subject=${d}&body=${encodeURIComponent(h)}`)}observeSlideVisibility(){this.slides=this.querySelectorAll(".slide"),this.observer=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio>=.5&&(this.currentIndex=+t.target.id.split("-")[1],this.updateIndicator(this.currentIndex),this.updateThumbnailStyle(this.currentIndex),this.updateDotSlider(this.currentIndex))}))}),{threshold:.5}),this.slides.forEach((t=>{this.observer.observe(t)}))}unobserveSlideVisibility(){this.slides.forEach((t=>{this.observer.unobserve(t)})),this.observer.disconnect()}async updateIndicator(t=0){this.indicatorElement.innerHTML=await this.translateContent("gallery.of",{current:(t+1).toString(),total:this.imageCount.toString()})}updateDotSlider(t=0){Array.from(this.dotSlider.children).forEach(((e,i)=>{e.classList.remove("dot-highlighted"),i===t&&e.classList.add("dot-highlighted")}))}updateThumbnailStyle(t=0){this.querySelectorAll(".thumbnail").forEach(((e,i)=>{e.classList.remove("active"),i===t&&(e.classList.add("active"),e.scrollIntoView())}))}getImageSlider(){const{images:t}=this.data.review;return`<div class="image-slider">\n      <div\n        class="previous navigation mobile-hide"\n        onclick="this.parentNode.parentNode.parentNode.parentNode.parentNode.previousSlide()"\n      >\n        ${G(this.baseUrl,"chevron-left")}\n      </div>\n      <div class="slides">\n        ${t.map(((t,e)=>`<img id="slide-${e}" class="slide" src="${t.url}" />`)).join("")}\n      </div>\n      <div\n        class="next navigation mobile-hide"\n        onclick="this.parentNode.parentNode.parentNode.parentNode.parentNode.nextSlide()"\n      >\n        ${G(this.baseUrl,"chevron-right")}\n      </div>\n    </div>`}async getReview(){const{title:t,comment:e,consumer:i,rating:s,date:n,isVerified:r}=this.data.review,a=await this.translateContent("review.noUserComment"),o=await this.translateContent("review.writtenBy"),l=await this.translateContent("review.verified"),c=await this.translateContent("imported.long"),d=await this.translateContent("review.readMore"),h=!!t||!!e,u=i&&i.firstName,p=!!t&&!((t,e)=>!(!t||!e)&&t.startsWith(e?.substring(0,e.length-3)))(e,t);return`<div class="review" onclick="event.stopPropagation()">\n      <div class="row justify-center sticky-top close-overlay-wrapper">\n        <div class="col-auto">\n          <div class="close-overlay">&#x2715;</div>\n        </div>\n      </div>\n      <div\n        class="header"\n        onclick="this.parentNode.parentNode.parentNode.parentNode.parentNode.showOverlay(event)"\n      >\n        <div class="row align-center">\n          <div class="col rating">\n            <etrusted-ig-star-rating\n              rating="${s}"\n            ></etrusted-ig-star-rating>\n          </div>\n          ${r?`<div class="col-auto verified">\n                  <span></span> ${l}\n                </div>`:`<div class="col-auto imported">\n                  ${c}\n                </div>`}\n        </div>\n        <div class="row">\n          <div class="col relative-time">\n            ${((t,e)=>{const i=new Intl.RelativeTimeFormat(t,{numeric:"auto"}),s=new Date,n=new Date(e),r=n.getTime()-s.getTime(),a=Math.trunc(r/1e3),o=Math.abs(a);let l=a,c="second";if(o>=60&&o<3600)l=Math.trunc(a/60),c="minute";else if(o>3600&&o<86400)l=Math.trunc(a/3600),c="hour";else if(o>=86400&&o<604800)l=Math.trunc(a/86400),c="day";else if(o>604800)return n.toLocaleDateString(t);return i.format(l,c)})(this.locale,n)}\n            ${u?`${o} ${i?.firstName||""}\n            ${i?.lastName||""}`:""}\n          </div>\n          <a class="col-auto mobile-show read-more">${d}</a>\n        </div>\n      </div>\n      <div class="row content mobile-hide">\n        <div class="col">\n          ${h?`\n              ${p?`<div class="title">${t||""}</div>`:""}\n              <div class="comment">${e||""}</div>\n            `:`<div class="disclaimer">${a}</div>`}\n        </div>\n      </div>\n    </div>`}getThumbnails(){const{images:t}=this.data.review;return`<div class="thumbnails mobile-hide">\n      ${t.map(((t,e)=>`<img\n            class="thumbnail"\n            src="${t.url}"\n            onclick="this.parentNode.parentNode.parentNode.parentNode.parentNode.scrollToSlide(${e})"\n          />`)).join("")}\n    </div>`}async getInformationBar(){const t=await this.translateContent("report.link");return` <div class="information-bar row align-center">\n      <div class="col">\n        <div class="close mobile-show">&#x2715;</div>\n      </div>\n      <div class="col text-center indicator">\n        ${this.currentIndex+1} of ${this.imageCount}\n      </div>\n      <div class="col">\n        <div class="row justify-right">\n          <div class="col-auto">\n            <a class="report-button" href="javascript:void(0)">\n              <span class="mobile-hide"> ${t} </span>\n              <span class="report-icon mobile-show">\n              </span>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>`}async render(){this.innerHTML=`\n      <div class="modal-wrapper" onclick="this.parentNode.hide()">\n        <div class="modal row" onclick="event.stopPropagation()">\n          <div class="gallery-wrapper">\n            ${this.getImageSlider()}\n            <div class="dot-slider mobile-show">\n              ${'<span class="dot"></span>'.repeat(this.imageCount)}\n            </div>\n            ${await this.getInformationBar()}\n          </div>\n          <div class="review-wrapper">\n            <div class="row justify-right mobile-hide">\n              <div class="col-auto">\n                <div class="close"></div>\n              </div>\n            </div>\n            ${await this.getReview()}\n            ${this.getThumbnails()}\n          </div>\n        </div>\n      </div>\n    `;const t=this.querySelector(".modal-wrapper");t&&(this.wrapperElement=t);const e=this.querySelector(".indicator");e&&(this.indicatorElement=e);const i=this.querySelector(".review-wrapper");i&&(this.reviewWrapperElement=i,this.reviewWrapperElement.onclick=t=>this.hideOverlay(t));const s=this.querySelector(".dot-slider");s&&(this.dotSlider=s);const n=this.querySelector(".report-button");n&&(n.onclick=()=>this.reportImage(this.data.review.images[this.currentIndex])),this.querySelectorAll(".close").forEach((t=>t.onclick=()=>this.hide()));const r=this.querySelector(".close-overlay");r&&(r.onclick=t=>this.hideOverlay(t)),this.observeSlideVisibility()}};H=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([B({selector:"etrusted-ig-modal"})],H);let k=class extends HTMLElement{alwaysUpdate;outsideModal;ATTRIBUTE_LOCALE="data-locale";ATTRIBUTE_BASE_URL="data-base-url";ATTRIBUTE_ACCENT_COLOR="data-accent-color";PAGE_SIZE=4;locale;baseUrl;modalElement;rootElement;_data;initialRender=!1;get data(){return this._data}set data(t){this._data=t,this.render()}constructor(t=!1,e){super(),this.alwaysUpdate=t,this.outsideModal=e}connectedCallback(){if(!this.initialRender){this.locale=this.getAttribute(this.ATTRIBUTE_LOCALE)||"",this.baseUrl=this.getAttribute(this.ATTRIBUTE_BASE_URL)||"";const t=this.getAttribute(this.ATTRIBUTE_ACCENT_COLOR)||"";if(!this.locale||!this.baseUrl)throw new Error("'data-locale' and 'data-base-url' need to be provided");this.attachShadow({mode:"open"}),this.rootElement=this.addRootElement(),this.addCssStyle(this.baseUrl),this.changeAccentColor(t),this.render()}this.initialRender=!this.alwaysUpdate}showModal(t){this.modalElement.show(t)}changeAccentColor(t){t&&this.style.setProperty("--accent-color",t)}addCssStyle(t){const e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=`@import "${t}/index.css"`,this.shadowRoot?.appendChild(e)}addRootElement(){const t=document.createElement("div");return t.classList.add("widget-image-gallery"),t.style.height="4.25em",t.style.display="flex",t.style.overflow="hidden",t.style.gap="0.5em",t.style.fontFamily="Helvetica, arial, sans-serif",t.style.fontSize="0.875em",this.shadowRoot?.appendChild(t),t}render(){if(!this.data)return;const{review:t}=this.data,{images:e}=t,i=e.length>=this.PAGE_SIZE;this.rootElement.innerHTML=`\n      ${e.slice(0,this.PAGE_SIZE).map(((t,e)=>`<img\n              style="height:100%"\n              class="thumbnail"\n              src="${t.url}"\n              loading="lazy"\n              onclick="this.getRootNode().host.showModal(${e})"\n            />`)).join("")}\n      ${i?`<div class="remaining-count" onclick="this.getRootNode().host.showModal(0)">\n              <span>+${e.length-this.PAGE_SIZE}</span>\n            </div>`:""}\n    `,this.modalElement||(this.outsideModal?this.modalElement=this.outsideModal:(this.modalElement=document.createElement("etrusted-ig-modal"),this.modalElement.setAttribute("baseUrl",this.baseUrl),this.modalElement.setAttribute("locale",this.locale))),this.outsideModal||this.rootElement.append(this.modalElement),this.modalElement.data={review:this.data.review}}};k=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([B({selector:"etrusted-widget-image-gallery"})],k);var j;let F=j=class extends HTMLElement{productReview;channelName;baseUrl;locale;showUGC;theme;fontStyle;accentColor;activeOSTheme;constructor(t,e,i,s,n,r,a,o,l){super(),this.productReview=t,this.channelName=e,this.baseUrl=i,this.locale=s,this.showUGC=n,this.theme=r,this.fontStyle=a,this.accentColor=o,this.activeOSTheme=l,this.setAttribute("theme",this.theme)}async connectedCallback(){const t=await c(this.baseUrl,this.locale,"review.writtenBy"),e=await c(this.baseUrl,this.locale,"review.replyFrom");this.productReview&&this.render(this.productReview,this.locale,this.baseUrl,this.theme,t,e)}static commentStartsWithTitle(t,e){return!(!t||!e)&&t.startsWith(e?.substring(0,e.length-3))}getGalleryElement(){const{locale:t,baseUrl:e,showUGC:i,theme:s,activeOSTheme:n,fontStyle:r,accentColor:a}=this,o=this.productReview.attachments?.images;return o&&0!==o.length&&i?`\n      <etrusted-widget-image-gallery\n        id="gallery-${this.productReview.id}"\n        data-locale="${t}"\n        data-base-url="${e}"\n        data-theme="${s===C.OS?n:s}"\n        data-font-style="${r}"\n        data-accent-color="${a}"\n      >\n      </etrusted-widget-image-gallery>\n    `:""}async getReplyElement(t,e,i,s){if(!i)return"";const n=await c(e,t,"review.replyEdited");return`\n      <div class="reply">\n        <div class="icon"></div>\n        <div class="title">${s} ${this.channelName}</div>\n        <div class="date">\n          ${M(t,i.addedAt)}${i.editedAt?` - ${n}`:""}\n        </div>\n        <div class="marker"></div>\n        <div class="comment">${i.comment}</div>\n      </div>\n    `}async render({rating:t,editedAt:e,submittedAt:i,transactionDate:s,consumer:n,title:r,comment:a,reply:o,isVerified:l},d,h,u,p,m){const g=!!r||!!a,v=n&&n.firstName,T=m&&o,E=this.productReview.attachments?.images,f=!!r&&!j.commentStartsWithTitle(a,r),w=await c(h,d,"imported.short"),y=M(d,e||i),b=await c(h,d,"dateTooltip.submission"),A="<br />"+await c(h,d,"dateTooltip.transaction")+" "+(s?M(d,s):y);this.innerHTML=`\n      <div class="review">\n        <div class="header">\n          <div class="row row--space-between">\n            <etrusted-rl-star-rating\n              baseurl="${h}"\n              rating="${t}"\n              theme="${u}"\n            ></etrusted-rl-star-rating>\n            ${l?'<div class="verified-icon">\n                  </div>':`<div class="imported-flag">\n                    ${w}\n                  </div>`}\n          </div>\n          <div class="row">\n            <etrusted-rc-tooltip content="${b} ${y} ${A}">\n                <span>${M(d,e||i)}</span>\n            </etrusted-rc-tooltip>\n            ${v?`<div class="consumer">\n                  ${p} ${n?.firstName||""} ${n?.lastName||""}\n                  </div>`:""}\n\n          </div>\n        </div>\n        ${E||g||T?`<div class="body">\n          ${g?`\n                  ${f?`<div class="title">${r||""}</div>`:""}\n                  <div class="comment">${a||""}</div>\n                `:""}\n          ${this.getGalleryElement()}\n          ${await this.getReplyElement(d,h,o,m)}\n        </div>`:""}\n      </div>`;const R=this.querySelector(`#gallery-${this.productReview.id}`);if(R){const t=this.productReview;R.data={review:{...t,date:t.editedAt||t.submittedAt,images:t.attachments?.images.map((t=>({id:t.id,url:t.original.url})))||[]}}}}};F=j=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-review-element"})],F);const q=F;let V=class extends HTMLElement{data;PAGE_SIZE=3;pageTotal=this.PAGE_SIZE;constructor(t){super(),this.data=t}async connectedCallback(){await this.render(this.data.reviews)}async update(t){const e=await t(this.data.reviews);this.pageTotal=this.PAGE_SIZE,await this.render(e)}loadMore(t){this.pageTotal+=this.PAGE_SIZE,this.render(t)}showLess(t){this.pageTotal=this.PAGE_SIZE,this.render(t)}async render(t){if(!this.data||0===this.data.grade.count)return;const{baseUrl:e,locale:i,channel:s,theme:n,fontStyle:r,showUGC:a,activeOSTheme:o,accentColor:l}=this.data,d=await c(e,i,"reviewList.noMoreReviews"),h=await c(e,i,"reviewList.loadMore"),u=await c(e,i,"reviewList.showLess"),p=!!t&&t.length>this.PAGE_SIZE,m=t.length>this.pageTotal,g=document.createElement("div");if(g.classList.add("footer"),m){const e=document.createElement("span");e.classList.add("action","load-more"),e.innerText=h,e.onclick=()=>this.loadMore(t),g.appendChild(e)}else{const e=document.createElement("span"),i=document.createElement("span");i.innerText=d,e.classList.add("action","show-less"),e.innerText=u,e.onclick=()=>this.showLess(t),i.appendChild(e),g.appendChild(i)}this.innerHTML='\n      <div class="review-list">\n        <div class="body"></div>\n      </div>\n    ';const v=this.querySelector(".review-list");p&&v?.appendChild(g);const T=this.querySelector(".body");t.slice(0,this.pageTotal).forEach((t=>{T.appendChild(new q(t,s.name,e,i,a,n,r,l,o))}))}};V=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-review-list"})],V);const W=V;var Y;!function(t){t.DEFAULT="default",t.INHERIT="inherit"}(Y||(Y={}));const Z=Y;let K=class extends HTMLElement{ATTRIBUTE_RATING="rating";MIN_GRADE=0;MAX_GRADE=5;async connectedCallback(){const t=+(this.getAttribute(this.ATTRIBUTE_RATING)??0);this.validate(t)&&this.render(t)}validate(t){return!(isNaN(t)||t<this.MIN_GRADE||t>this.MAX_GRADE)}render(t){const e=Math.floor(t),i=t%1*100,s='<div class="empty"></div>',n='<div class="filled"></div>';this.innerHTML=`\n      <div class="star-rating">\n        ${n.repeat(e)}\n        ${e!==this.MAX_GRADE?`\n              <div class="star-rating__fraction">\n                <div class="star">\n                  ${s}\n                </div>\n                <div class="star" style="width: ${i}%">\n                  ${n}\n                </div>\n              </div>\n              ${s.repeat(this.MAX_GRADE-e-1)}\n            `:""}\n      </div>\n    `}};K=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-rl-star-rating"})],K);let X=class extends HTMLElement{ATTRIBUTE_BASE_URL="baseUrl";ATTRIBUTE_LOCALE="locale";ATTRIBUTE_THEME="theme";ATTRIBUTE_ACCENT_COLOR="data-accent-color";DEFAULT_ACCENT_COLOR="#ffdc0f";baseUrl;locale;theme;accentColor;rootElement;_data;get data(){return this._data}set data(t){this._data=t,this.render()}connectedCallback(){this.baseUrl=this.getAttribute(this.ATTRIBUTE_BASE_URL)||".",this.locale=this.getAttribute(this.ATTRIBUTE_LOCALE)||"en-GB",this.theme=this.getAttribute(this.ATTRIBUTE_THEME)||C.DARK,this.accentColor=this.getAttribute(this.ATTRIBUTE_ACCENT_COLOR)||"",this.shadowRoot||(this.attachShadow({mode:"open"}),this.addCssStyle(this.baseUrl),this.rootElement=this.addRootElement(),this.changeAccentColor())}addCssStyle(t){const e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=`@import "${t}/index.css"`,this.shadowRoot?.appendChild(e)}addRootElement(){const t=document.createElement("div");return t.classList.add("star-extension"),this.shadowRoot?.appendChild(t),t}changeAccentColor(){const t=this.accentColor||this.DEFAULT_ACCENT_COLOR;this.style.setProperty("--accent-color",t)}render(){const{grade:t}=this.data,e=0===t.count?"":`\n          <span class="grade"> ${n(this.locale,t.rating,2,2)} </span>\n          <span class="count"> (${n(this.locale,t.count)}) </span>\n        `;this.rootElement.innerHTML=`\n      <div class="wrapper">\n        <etrusted-rl-star-rating\n          rating="${t.rating}"\n          theme="${this.theme}"\n        ></etrusted-rl-star-rating>\n        ${e}\n      </div>\n    `}};X=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-star-extension"})],X);var z;let J=z=class extends HTMLElement{CURRENT_MAJOR_VERSION="v1";QUERY_SELECTOR_PROPS='script[type="text/props"]';ATTRIBUTE_LOCALE="data-etrusted-locale";ATTRIBUTE_THEME="data-theme";ATTRIBUTE_FONT_STYLE="data-font-style";ATTRIBUTE_UGC="data-ugc";ATTRIBUTE_SKU="data-sku";ATTRIBUTE_GTIN="data-gtin";ATTRIBUTE_MPN="data-mpn";ATTRIBUTE_ACCENT_COLOR="data-accent-color";DEFAULT_ACCENT_COLOR="#ffdc0f";LAYOUT_BREAKPOINT_PX=700;rootElement;context;visibilityObserver;ratingDistribution;reviewList;placeholders;osThemeHost=window.matchMedia("(prefers-color-scheme: dark)");sortedSkus;intersectionObserver;themeListener=t=>{this.setToOsStyle(t.matches)};async connectedCallback(){const t=this.getRootNode()?.host||this,e=this.getAttribute(this.ATTRIBUTE_LOCALE),i=this.getManifest(),s=this.getAttribute(this.ATTRIBUTE_THEME),n=this.getAttribute(this.ATTRIBUTE_FONT_STYLE),r=this.getAttribute(this.ATTRIBUTE_ACCENT_COLOR)||"",a=this.getAttribute(this.ATTRIBUTE_UGC),o="true"===a;if(!i)return;const l=await this.getBaseUrl(i.application.url),c=z.getDistributionUrl(i.application.url||l),d=this.getAttribute(this.ATTRIBUTE_SKU)?.split(","),h=this.getAttribute(this.ATTRIBUTE_GTIN)?.split(","),u=this.getAttribute(this.ATTRIBUTE_MPN)?.split(","),f=new m(d,h,u);if(this.shadowRoot)return;this.attachShadow({mode:"open"}),this.addCssStyle(l),this.rootElement=this.addRootElement();const y=await v(i.configuration.url),b=await v(i.feeds.channels.url),A=z.getTrackingQueryString(i.id,b.id,y.showUGC),S=i.dynamicFeeds.gtin_mapping?i.dynamicFeeds.gtin_mapping.url:`${c}/feeds/mappings/gtin/v1/channels/${b.id}/${g}/mapping.json`,L=f.getType()===p.GTIN?await(async(t,e)=>{if(e.getType()!==p.GTIN)throw new Error("Product Identifier needs to be GTIN");const i=await Promise.all(e.getIdentifiers().map((e=>(async(t,e)=>{try{return await T(t,p.GTIN,e)}catch{return}})(t,e)))),s=i.filter((t=>!!t)).filter((t=>!!t)).map((t=>t.products.map((t=>t.sku)))).flat();return new m(s)})(S,f):f,O=await(async(t,e)=>{const i=e.getType(),s=e.getEncodedIdentifiers();return(t=>{const e=new Set;return t.filter((t=>{const i=t.id;return!e.has(i)&&(e.add(i),!0)}))})((await Promise.all(s.map((async e=>{try{return await T(t,i,e)}catch{return}})))).filter((t=>!!t)))})(i.dynamicFeeds.products.url,L),U=new m(O.map((t=>t.sku)),void 0,void 0),I=await(async(t,e,i)=>{const s=e.getType(),n=e.getEncodedIdentifiers();return(await Promise.all(n.map((async e=>{try{return await T(t,s,e,i)}catch{return[]}})))).flatMap((t=>t)).sort(((t,e)=>((t,e)=>{const i=new Date(t.editedAt||t.submittedAt),s=new Date(e.editedAt||e.submittedAt);return i.getTime()<s.getTime()?-1:i.getTime()>s.getTime()?1:0})(e,t)))})(i.dynamicFeeds.product_reviews.url,U,A),_=await(async(t,e)=>{const i=e.getType(),s=e.getCombinedIdentifier();if(i!==p.SKU)throw new Error("Unsupported product identifier type");return(await Promise.all(s.map((async e=>{try{return{sku:e.identifier,feed:await T(t,i,e.encoded)}}catch{return}})))).filter((t=>t&&!!t.feed))})(i.dynamicFeeds.grades.url,U),$=_.sort(((t,e)=>t.feed.grades.overall.count-e.feed.grades.overall.count)),N=(t=>{let e=[0,0,0,0,0],i=0,s=0;t.length>0&&(e=E.map((e=>t.map((({distribution:t})=>t[e])).reduce(((t,e)=>e+t),0))),i=t.map((t=>t.count)).reduce(((t,e)=>e+t),0),s=e.reduce(((t,e,i)=>e*(i+1)+t),0)/i);const[n,r,a,o,l]=e;return{count:i,distribution:{fiveStars:l,fourStars:o,threeStars:a,twoStars:r,oneStar:n},rating:s}})($.map((t=>t.feed.grades.overall)));this.sortedSkus=$.map((t=>t.sku)),this.context={baseUrl:l,manifest:i,showUGC:(a?o:y.showUGC)||!1,configuration:{...y,locale:e||y.locale},fontStyle:n||y.fontStyle||Z.DEFAULT,accentColor:r||y.accentColor||this.DEFAULT_ACCENT_COLOR,theme:s||y.theme||C.LIGHT,channel:b,products:O,reviews:I,grade:N},y.hideWhenEmpty&&0===N.rating||(y.isRichSnippetEnabled&&((t,e)=>{const{products:i,grade:s}=e,n=(t=>{const e=t.map((t=>Array.from(t.childNodes).map((t=>t)).filter((t=>"SCRIPT"===t.nodeName&&t.outerHTML.match(/application\/ld\+json/))).map((t=>{try{return JSON.parse(t.innerHTML)}catch{return{}}})))).flat(),i=e.filter((t=>Array.isArray(t))),s=e.filter((t=>Array.isArray(t["@graph"]))).map((t=>t["@graph"])).flat(),n=e.filter((t=>t["@type"]==w.PRODUCTGROUP)),r=n.map((t=>t.hasVariant)).flat();return[...n,...e,...i,...s,...r].filter((t=>[w.PRODUCT,w.PRODUCTGROUP].includes(t["@type"])))})(t);if(n.filter((t=>t["@type"]==w.PRODUCT&&t.aggregateRating)).length>0)return;if(0===i.length)return;if(0===s.count||0===s.rating)return;const r=n.find((t=>!!t["@id"])),a=r?((t,e,i)=>{const s=R(t,i);return e["@id"]&&(s["@id"]=e["@id"]),s})(e,r,n):R(e,n),o=document.createElement("script");o.setAttribute("type","application/ld+json"),o.appendChild(document.createTextNode(JSON.stringify(a))),t[0].appendChild(o)})([document.head,document.body],{grade:N,reviews:I,products:O}),await this.render(),this.changeAccentColor(this.context.accentColor),this.setAttribute(this.ATTRIBUTE_THEME,this.context.theme),this.setAttribute(this.ATTRIBUTE_FONT_STYLE,this.context.fontStyle),this.renderExtensions(),this.updateDisplayStyle(),this.observeVisibility(),this.intersectionObserver=new IntersectionObserver(this.updateDisplayStyle,{root:t.parentElement,rootMargin:"0px",threshold:1}),this.intersectionObserver.observe(this),window.addEventListener("resize",this.updateDisplayStyle,!0),this.setupMutationObserver(t),this.handleOSStyleListener(this.context.theme!==C.OS))}disconnectedCallback(){window.removeEventListener("resize",this.updateDisplayStyle,!0),this.visibilityObserver?.unobserve(this),this.visibilityObserver?.disconnect(),this.visibilityObserver=void 0,this.intersectionObserver?.unobserve(this),this.intersectionObserver?.disconnect(),this.intersectionObserver=void 0,this.handleOSStyleListener(!0)}changeAccentColor(t){const e=t||this.DEFAULT_ACCENT_COLOR;this.style.setProperty("--accent-color",e),this.renderExtensions()}static getTrackingQueryString(t,e,i){return i?"?"+[["widgetId",t],["channelId",e],["showUGC",i]].map((t=>t.join("="))).join("&"):""}setupMutationObserver(t){const e=new MutationObserver((async e=>{t!==this&&(e.forEach((e=>{const i=e.attributeName,s=t.getAttribute(i);if(i===this.ATTRIBUTE_THEME){const t=this.context.theme;this.context.theme=s??this.context.configuration.theme,this.setAttribute(this.ATTRIBUTE_THEME,s),this.handleOSStyleListener(C.OS===t||C.OS!==this.context.theme)}if(i===this.ATTRIBUTE_LOCALE&&(this.context.configuration.locale=s,this.setAttribute(this.ATTRIBUTE_LOCALE,s)),i===this.ATTRIBUTE_FONT_STYLE&&(this.context.fontStyle=s,this.setAttribute(this.ATTRIBUTE_FONT_STYLE,s)),i===this.ATTRIBUTE_ACCENT_COLOR&&(this.context.accentColor=s,this.setAttribute(this.ATTRIBUTE_ACCENT_COLOR,s),this.changeAccentColor(s)),i===this.ATTRIBUTE_UGC){const t="true"===s;this.context.showUGC=t,this.setAttribute(this.ATTRIBUTE_UGC,s)}})),await this.render(),this.renderExtensions())}));return e.observe(t,{attributes:!0}),e}setToOsStyle=t=>{this.context.activeOSTheme=t?"dark":"light",this.setAttribute(this.ATTRIBUTE_THEME,this.context.activeOSTheme)};handleOSStyleListener(t=!1){if(this.context?.theme){if(this.context.theme===C.OS||!t)return this.setToOsStyle(this.osThemeHost.matches),void this.osThemeHost.addEventListener("change",this.themeListener);this.osThemeHost.removeEventListener("change",this.themeListener)}}observeVisibility(){this.visibilityObserver=new IntersectionObserver((()=>{this.updateDisplayStyle()}),{root:document.documentElement}),this.visibilityObserver.observe(this)}getManifest=()=>{const t=this.querySelector(this.QUERY_SELECTOR_PROPS)?.textContent;return t?JSON.parse(t).manifest:null};addCssStyle(t){const e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=`@import "${t}/index.css"`,this.shadowRoot?.appendChild(e)}addRootElement(){const t=document.createElement("div");return t.classList.add("product-review-list-widget"),this.shadowRoot?.appendChild(t),t}async getBaseUrl(e){if(!e)return".";const i=await t(`${e}/LATEST_VERSION`);return e.replace(this.CURRENT_MAJOR_VERSION,i.trim())||"."}static getDistributionUrl(t){return t&&"."!==t?new URL(t).origin:t}updateDisplayStyle=()=>{setTimeout((()=>{const t=this.shadowRoot?.querySelector(".product-review-list-widget");t&&(t.offsetWidth<this.LAYOUT_BREAKPOINT_PX?t.classList.add("product-review-list-widget--vertical"):t.classList.remove("product-review-list-widget--vertical"))}))};renderExtensions=()=>{const{baseUrl:t,configuration:e,grade:i}=this.context;if(this.placeholders=document.querySelectorAll("etrusted-product-review-list-widget-product-star-extension"),this.placeholders&&this.placeholders.length>0){const s=document.createElement("etrusted-star-extension");s.setAttribute("baseUrl",t),s.setAttribute("locale",e.locale),s.setAttribute(this.ATTRIBUTE_FONT_STYLE,this.context.fontStyle),s.setAttribute(this.ATTRIBUTE_THEME,this.getAttribute(this.ATTRIBUTE_THEME)),s.setAttribute(this.ATTRIBUTE_ACCENT_COLOR,this.context.accentColor||this.DEFAULT_ACCENT_COLOR),s.onclick=()=>this.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),this.placeholders.forEach((t=>{t.innerHTML="",t.appendChild(s)})),s.data={grade:i}}};async render(){if(!this.shadowRoot)return;this.rootElement.innerHTML="";const{baseUrl:t,configuration:e,grade:i,channel:s,reviews:n,theme:r,fontStyle:a,showUGC:o,activeOSTheme:l,accentColor:c}=this.context,d=e.locale,h=document.createElement("div");h.classList.add("col-40");const u=document.createElement("div");u.classList.add("col-60"),this.reviewList=new W({baseUrl:t,locale:d,channel:s,grade:i,reviews:n,showUGC:o,theme:r,fontStyle:a,accentColor:c,activeOSTheme:l});const p=new N({baseUrl:t,locale:d,theme:r,grade:i},this.reviewList);this.sortedSkus,this.ratingDistribution=new U({baseUrl:t,locale:d,channel:s,grade:i,theme:r});const m=document.createElement("div");m.classList.add("bar");const g=document.createElement("div");g.classList.add("bar-action");const v=document.createElement("div");v.classList.add("bar-content"),g.append(p),m.append(g,v),h.append(this.ratingDistribution),u.append(m,this.reviewList),this.rootElement.append(h,u)}};J=z=function(t,e,i,s){var n,r=arguments.length,a=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}([d({selector:"etrusted-product-review-list-widget"})],J)})();