(function(){"use strict";const I=["click","input","pointerdown","touchstart","mousedown"],z="#motive-container, #motive-x";function Z(e){function t(r){var n,o;if(!(!(r.target instanceof Element)||!r.target.closest(e.triggerSelector)||r.target.closest(z))){r.target instanceof HTMLInputElement?((n=window.InterfaceX)==null||n.search(r.target.value),r.target.value=""):(o=window.InterfaceX)==null||o.search();try{r.cancelable&&r.preventDefault(),e.isolated&&r.stopImmediatePropagation()}catch{}}}return I.forEach(r=>document.addEventListener(r,t,!0)),function(){I.forEach(n=>document.removeEventListener(n,t,!0))}}function ee(e){te(e,"a",t=>t.href="javascript:void(0)")}function te(e,t,r){Array.from(document.querySelectorAll(e)).map(n=>n.closest(t)??n.querySelector(t)).filter((n,o,s)=>!!n&&s.indexOf(n)===o).forEach(r)}async function $(e,t="module"){return new Promise(r=>{const n=document.createElement("script");n.type=t,n.src=e,n.onload=r,document.head.appendChild(n)})}async function re(e,t=100){if(!e())return new Promise(r=>{const n=setInterval(()=>{e()&&(clearInterval(n),r())},t)})}async function ne(e,t){var r;await $("https://assets.motive.co/wysiwyg/wysiwyg.js"),await((r=window.wysiwyg)==null?void 0:r.setConfig({auth:{baseUrl:"https://iam.motive.co",clientId:"wysiwyg"},analytics:{baseUrl:"https://statistics.api.motive.co"},catalog:{baseUrl:"https://analytics.api.motive.co"},search:{baseUrl:"https://search-platform.motive.co"},tagging:{baseUrl:"https://tagging-playboard.api.motive.co"},instance:e,lang:t,playboardUrl:"https://playboard.motive.co",audience:"sme",appContainerSelector:"#motive-container",searchLayerSelector:"#motive-x"}))}const R="GraphQL Client",D=0,U=3,N="An error occurred while fetching from the API. Review 'graphQLErrors' for details.",O="Response returned unexpected Content-Type:",x="An unknown error has occurred. The API did not return a data object or any errors in its response.",T={json:"application/json",multipart:"multipart/mixed"},P="X-SDK-Variant",L="X-SDK-Version",oe="shopify-graphql-client",se="1.3.0",j=1e3,ie=[429,503],k=/@(defer)\b/i,V=`\r
`,ae=/boundary="?([^=";]+)"?/i,q=V+V;function y(e,t=R){return e.startsWith(`${t}`)?e:`${t}: ${e}`}function g(e){return e instanceof Error?e.message:JSON.stringify(e)}function H(e){return e instanceof Error&&e.cause?e.cause:void 0}function M(e){return e.flatMap(({errors:t})=>t??[])}function F({client:e,retries:t}){if(t!==void 0&&(typeof t!="number"||t<D||t>U))throw new Error(`${e}: The provided "retries" value (${t}) is invalid - it cannot be less than ${D} or greater than ${U}`)}function f(e,t){return t&&(typeof t!="object"||Array.isArray(t)||typeof t=="object"&&Object.keys(t).length>0)?{[e]:t}:{}}function K(e,t){if(e.length===0)return t;const n={[e.pop()]:t};return e.length===0?n:K(e,n)}function X(e,t){return Object.keys(t||{}).reduce((r,n)=>(typeof t[n]=="object"||Array.isArray(t[n]))&&e[n]?(r[n]=X(e[n],t[n]),r):(r[n]=t[n],r),Array.isArray(e)?[...e]:{...e})}function G([e,...t]){return t.reduce(X,{...e})}function ce({clientLogger:e,customFetchApi:t=fetch,client:r=R,defaultRetryWaitTime:n=j,retriableCodes:o=ie}){const s=async(c,a,i)=>{const u=a+1,l=i+1;let d;try{if(d=await t(...c),e({type:"HTTP-Response",content:{requestParams:c,response:d}}),!d.ok&&o.includes(d.status)&&u<=l)throw new Error;return d}catch(p){if(u<=l){const h=d==null?void 0:d.headers.get("Retry-After");return await ue(h?parseInt(h,10):n),e({type:"HTTP-Retry",content:{requestParams:c,lastResponse:d,retryAttempt:a,maxRetries:i}}),s(c,u,i)}throw new Error(y(`${i>0?`Attempted maximum number of ${i} network retries. Last message - `:""}${g(p)}`,r))}};return s}async function ue(e){return new Promise(t=>setTimeout(t,e))}function le({headers:e,url:t,customFetchApi:r=fetch,retries:n=0,logger:o}){F({client:R,retries:n});const s={headers:e,url:t,retries:n},c=de(o),a=ce({customFetchApi:r,clientLogger:c,defaultRetryWaitTime:j}),i=fe(a,s),u=pe(i),l=Se(i);return{config:s,fetch:i,request:u,requestStream:l}}function de(e){return t=>{e&&e(t)}}async function Q(e){const{errors:t,data:r,extensions:n}=await e.json();return{...f("data",r),...f("extensions",n),headers:e.headers,...t||!r?{errors:{networkStatusCode:e.status,message:y(t?N:x),...f("graphQLErrors",t),response:e}}:{}}}function fe(e,{url:t,headers:r,retries:n}){return async(o,s={})=>{const{variables:c,headers:a,url:i,retries:u,keepalive:l,signal:d}=s,p=JSON.stringify({query:o,variables:c});F({client:R,retries:u});const h=Object.entries({...r,...a}).reduce((w,[S,C])=>(w[S]=Array.isArray(C)?C.join(", "):C.toString(),w),{});return!h[P]&&!h[L]&&(h[P]=oe,h[L]=se),e([i??t,{method:"POST",headers:h,body:p,signal:d,keepalive:l}],1,u??n)}}function pe(e){return async(...t)=>{if(k.test(t[0]))throw new Error(y("This operation will result in a streamable response - use requestStream() instead."));try{const r=await e(...t),{status:n,statusText:o}=r,s=r.headers.get("content-type")||"";return r.ok?s.includes(T.json)?Q(r):{errors:{networkStatusCode:n,message:y(`${O} ${s}`),response:r}}:{errors:{networkStatusCode:n,message:y(o),response:r}}}catch(r){return{errors:{message:g(r)}}}}}async function*he(e){const t=new TextDecoder;if(e.body[Symbol.asyncIterator])for await(const r of e.body)yield t.decode(r);else{const r=e.body.getReader();let n;try{for(;!(n=await r.read()).done;)yield t.decode(n.value)}finally{r.cancel()}}}function ye(e,t){return{async*[Symbol.asyncIterator](){try{let r="";for await(const n of e)if(r+=n,r.indexOf(t)>-1){const o=r.lastIndexOf(t),c=r.slice(0,o).split(t).filter(a=>a.trim().length>0).map(a=>a.slice(a.indexOf(q)+q.length).trim());c.length>0&&(yield c),r=r.slice(o+t.length),r.trim()==="--"&&(r="")}}catch(r){throw new Error(`Error occured while processing stream payload - ${g(r)}`)}}}}function me(e){return{async*[Symbol.asyncIterator](){yield{...await Q(e),hasNext:!1}}}}function ge(e){return e.map(t=>{try{return JSON.parse(t)}catch(r){throw new Error(`Error in parsing multipart response - ${g(r)}`)}}).map(t=>{const{data:r,incremental:n,hasNext:o,extensions:s,errors:c}=t;if(!n)return{data:r||{},...f("errors",c),...f("extensions",s),hasNext:o};const a=n.map(({data:i,path:u,errors:l})=>({data:i&&u?K(u,i):{},...f("errors",l)}));return{data:a.length===1?a[0].data:G([...a.map(({data:i})=>i)]),...f("errors",M(a)),hasNext:o}})}function Ee(e,t){if(e.length>0)throw new Error(N,{cause:{graphQLErrors:e}});if(Object.keys(t).length===0)throw new Error(x)}function we(e,t){var a,i;const r=(t??"").match(ae),n=`--${r?r[1]:"-"}`;if(!((a=e.body)!=null&&a.getReader)&&!((i=e.body)!=null&&i[Symbol.asyncIterator]))throw new Error("API multipart response did not return an iterable body",{cause:e});const o=he(e);let s={},c;return{async*[Symbol.asyncIterator](){var u;try{let l=!0;for await(const d of ye(o,n)){const p=ge(d);c=((u=p.find(m=>m.extensions))==null?void 0:u.extensions)??c;const h=M(p);s=G([s,...p.map(({data:m})=>m)]),l=p.slice(-1)[0].hasNext,Ee(h,s),yield{...f("data",s),...f("extensions",c),hasNext:l}}if(l)throw new Error("Response stream terminated unexpectedly")}catch(l){const d=H(l);yield{...f("data",s),...f("extensions",c),errors:{message:y(g(l)),networkStatusCode:e.status,...f("graphQLErrors",d==null?void 0:d.graphQLErrors),response:e},hasNext:!1}}}}}function Se(e){return async(...t)=>{if(!k.test(t[0]))throw new Error(y("This operation does not result in a streamable response - use request() instead."));try{const r=await e(...t),{statusText:n}=r;if(!r.ok)throw new Error(n,{cause:r});const o=r.headers.get("content-type")||"";switch(!0){case o.includes(T.json):return me(r);case o.includes(T.multipart):return we(r,o);default:throw new Error(`${O} ${o}`,{cause:r})}}catch(r){return{async*[Symbol.asyncIterator](){const n=H(r);yield{errors:{message:y(g(r)),...f("networkStatusCode",n==null?void 0:n.status),...f("response",n)},hasNext:!1}}}}}}function Ae({client:e,storeDomain:t}){try{if(!t||typeof t!="string")throw new Error;const r=t.trim(),n=r.match(/^https?:/)?r:`https://${r}`,o=new URL(n);return o.protocol="https",o.origin}catch(r){throw new Error(`${e}: a valid store domain ("${t}") must be provided`,{cause:r})}}function B({client:e,currentSupportedApiVersions:t,apiVersion:r,logger:n}){const o=`${e}: the provided apiVersion ("${r}")`,s=`Currently supported API versions: ${t.join(", ")}`;if(!r||typeof r!="string")throw new Error(`${o} is invalid. ${s}`);const c=r.trim();t.includes(c)||(n?n({type:"Unsupported_Api_Version",content:{apiVersion:r,supportedApiVersions:t}}):console.warn(`${o} is likely deprecated or not supported. ${s}`))}function v(e){const t=e*3-2;return t===10?t:`0${t}`}function b(e,t,r){const n=t-r;return n<=0?`${e-1}-${v(n+4)}`:`${e}-${v(n)}`}function Re(){const e=new Date,t=e.getUTCMonth(),r=e.getUTCFullYear(),n=Math.floor(t/3+1);return{year:r,quarter:n,version:`${r}-${v(n)}`}}function ve(){const{year:e,quarter:t,version:r}=Re(),n=t===4?`${e+1}-01`:`${e}-${v(t+1)}`;return[b(e,t,3),b(e,t,2),b(e,t,1),r,n,"unstable"]}function Ce(e){return t=>({...t??{},...e.headers})}function Te({getHeaders:e,getApiUrl:t}){return(r,n)=>{const o=[r];if(n&&Object.keys(n).length>0){const{variables:s,apiVersion:c,headers:a,retries:i}=n;o.push({...s?{variables:s}:{},...a?{headers:e(a)}:{},...c?{url:t(c)}:{},...i?{retries:i}:{}})}return o}}const Y="application/json",be="storefront-api-client",_e="1.0.5",Ie="X-Shopify-Storefront-Access-Token",$e="Shopify-Storefront-Private-Token",De="X-SDK-Variant",Ue="X-SDK-Version",Ne="X-SDK-Variant-Source",E="Storefront API Client";function Oe(e){if(e&&typeof window<"u")throw new Error(`${E}: private access tokens and headers should only be used in a server-to-server implementation. Use the public API access token in nonserver environments.`)}function xe(e,t){if(!e&&!t)throw new Error(`${E}: a public or private access token must be provided`);if(e&&t)throw new Error(`${E}: only provide either a public or private access token`)}function Pe({storeDomain:e,apiVersion:t,publicAccessToken:r,privateAccessToken:n,clientName:o,retries:s=0,customFetchApi:c,logger:a}){const i=ve(),u=Ae({client:E,storeDomain:e}),l={client:E,currentSupportedApiVersions:i,logger:a};B({...l,apiVersion:t}),xe(r,n),Oe(n);const d=Le(u,t,l),p={storeDomain:u,apiVersion:t,...r?{publicAccessToken:r}:{privateAccessToken:n},headers:{"Content-Type":Y,Accept:Y,[De]:be,[Ue]:_e,...o?{[Ne]:o}:{},...r?{[Ie]:r}:{[$e]:n}},apiUrl:d(),clientName:o},h=le({headers:p.headers,url:p.apiUrl,retries:s,customFetchApi:c,logger:a}),m=Ce(p),w=je(p,d),S=Te({getHeaders:m,getApiUrl:w});return Object.freeze({config:p,getHeaders:m,getApiUrl:w,fetch:(...A)=>h.fetch(...S(...A)),request:(...A)=>h.request(...S(...A)),requestStream:(...A)=>h.requestStream(...S(...A))})}function Le(e,t,r){return n=>{n&&B({...r,apiVersion:n});const o=(n??t).trim();return`${e}/api/${o}/graphql.json`}}function je(e,t){return r=>r?t(r):e.apiUrl}let J="",_=null;function ke(e,t,r){if(!(!e||!t))return _=Pe({storeDomain:t,apiVersion:"2024-04",publicAccessToken:e}),J=r?`@inContext(${Object.entries(r).map(([n,o])=>`${n}: ${o}`).join(",")})`:"",Ve}async function Ve(e){if(!e.length||!_)return[];const t=`#graphql
    query products ${J} {
      ${e.map((n,o)=>`
        product${o}: product(id: "${n.id}") {
          id
          onlineStoreUrl
          variants(first: 15) {
            nodes {
              id
              price {
                amount
                currencyCode
              }
              compareAtPrice {
                amount
                currencyCode
              }
            }
          }
        }
      `).join()}
    }`,r=await _.request(t);return r!=null&&r.data?Object.values(r.data).filter(n=>!!n).map(n=>({id:n.id,...!!n.onlineStoreUrl&&{url:n.onlineStoreUrl},variants:n.variants.nodes.map(o=>({id:o.id.toLowerCase(),price:qe(o),...!!n.onlineStoreUrl&&{url:n.onlineStoreUrl}}))})):[]}function qe(e){var n;const t=+e.price.amount,r=+(((n=e.compareAtPrice)==null?void 0:n.amount)??0);return{value:t,originalValue:r,hasDiscount:r>t}}function He(e){const t=Number.parseFloat(e.currency.rate??"1");return(r,n)=>[r*t,n*t]}async function Me(){try{const e=await Ke();if(!e.trigger_selector||!e.engine)return;Z({triggerSelector:e.trigger_selector,isolated:!0}),await Fe(e),await ne(e.engine.uuid,Shopify.locale)}catch(e){console.log("Error retrieving config:",e)}}async function Fe(e){const t=typeof MotiveStorefrontToken<"u"?MotiveStorefrontToken:"";window.initX=function(){const n=ke(t,Shopify.shop,e.useContext?{country:Shopify.country,language:Shopify.locale.toUpperCase()}:void 0);return ee(e.trigger_selector),{xEngineId:e.engine.uuid,lang:Shopify.locale,currency:Shopify.currency.active,triggerSelector:e.trigger_selector,isolated:!0,externalOpen:!0,cartUrl:"/cart",variantAddToCart:"SINGLE",callbacks:{CartHandlerGettingCartInfo:()=>({productsCount:MotiveCartInfo.item_count}),UserClickedResultAddToCart:Ge,AppendedResultsChanged:n,RecommendationsChanged:n},...t&&{transformPriceRange:He(Shopify)}}},await $(e.motive_x_url)}async function Ke(){var t;await re(()=>!!Shopify.shop&&!!Shopify.locale&&!!Shopify.country);const e=await Xe();return e.engine=(t=e.engines)==null?void 0:t.find(r=>r.locale===Shopify.locale&&r.countries.includes(Shopify.country)),e}async function Xe(){if(typeof Motive<"u"&&Motive)return Motive;const e={"x-store-name":Shopify.shop};return await(await fetch("https://motive.api.motive.co/shopify/store/config",{headers:e})).json()}async function Ge(e,t={}){var l;const r=(l=e.variants)==null?void 0:l[0];if(!r)return;const n=r.id.replace(/\D/g,""),o=(t==null?void 0:t.quantity)??1,a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:n,quantity:o}],sections:"cart-icon-bubble,header"})},i=await fetch(`${Shopify.routes.root}cart/add.js`,a);if(!i.ok)throw new Error("Error adding item to cart.");const u=await i.json();MotiveCartInfo.item_count+=o,u.sections["cart-icon-bubble"]?W("#cart-icon-bubble",u.sections["cart-icon-bubble"]):u.sections.header&&W("#shopify-section-header",u.sections.header)}function W(e,t){const r=document.querySelector(e);r&&(r.innerHTML=t)}Me()})();
